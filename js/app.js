!function(e){"use strict";e.module("vehicles.constants",[]).constant("VEHICLES",["bike","boat","bus","car","helicopter","lorry","moped","motorbike","plane","rocket","ship","submarine","train","van"])}(window.angular,window._),function(e){"use strict";var n=e.module("speech",[]);n.factory("Speech",["$log","$q",function(e,n){var t=("speechSynthesis"in window,[]);speechSynthesis.onvoiceschanged=function(){t=speechSynthesis.getVoices()};var r=function(n){var r=function(e){return e.lang===n},i=t.filter(r),o=i.slice(-1)[0];return o||e.warn('Could not select voice for "%s"',n),o},i={say:function(e){var t=new SpeechSynthesisUtterance(e),i=n(function(e,n){t.onend=e,t.onerror=n}),c=r(o);return c?t.voice=c:t.lang=o,speechSynthesis.speak(t),i}},o=null;return Object.defineProperty(i,"language",{get:function(){return o},set:function(e){o=e},enumerable:!0,configurable:!0}),i}])}(window.angular,window._),function(e){"use strict";var n=e.module("storage",[]),t=function(n){return function(){return{get:function(t){var r=n.getItem(t);return r?e.fromJson(r):r},put:function(t,r){n.setItem(t,e.toJson(r))},remove:function(e){n.removeItem(e)},clear:function(){n.clear()}}}};n.factory("LocalStore",t(localStorage)),n.factory("SessionStore",t(sessionStorage))}(window.angular,window._),function(e,n){"use strict";var t=["red","pink","indigo","purple","blue","light-blue","cyan","teal","green","lime","yellow","amber","orange","deep-orange","brown"],r=e.module("vehicles.directives",["vehicles.constants","speech","storage"]);r.directive("vehicles",function(){var e=function(e){return{name:e,id:n.uniqueId(),is_selected:!1,is_winner:!1}},r=["${name}, can you find the ${vehicle}?","${name}, where is the ${vehicle}?"],i=n.map(r,n.template),o=n.template("Try again. Where's the ${vehicle}?");return{templateUrl:"/partials/vehicles.html",controller:["$scope","$attrs","VEHICLES","Speech",function(r,c,s,l){var a=this;a.init=function(){a.theme=n.sample(t),a.rows=r.$eval(c.rows),a.columns=r.$eval(c.columns);var i=r.$eval(c.selectedVehicle),o=n.difference(s,[i]),l=a.rows*a.columns-1,u=n.sample(o,l),h=n.map(u,e);a.selected_vehicle=e(i),h.push(a.selected_vehicle),h=n.shuffle(h),a.vehicles=n.chunk(h,a.columns),a.is_winner_guessed=!1,a.speak_clue()},a.speak_clue=function(){var e=n.sample(i);l.say(e({name:r.game_controller.name,vehicle:a.selected_vehicle.name}))},a.guess=function(e){e.is_selected||a.is_winner_guessed||(e.id===a.selected_vehicle.id?(e.is_winner=!0,a.is_winner_guessed=!0,l.say("Thats right!").then(function(){r.game_controller.advance_level()})):(e.is_selected=!0,l.say(o({vehicle:a.selected_vehicle.name}))))},a.init()}],controllerAs:"vehicles_controller"}}),r.directive("nameCapture",function(){return{templateUrl:"/partials/name_capture.html",controller:["$scope","SessionStore",function(e,n){e.name=n.get("player.name")||null,e.is_submitted=!1,this.read_name=function(){n.put("player.name",e.name),e.game_controller.set_name(e.name),e.is_submitted=!0}}],controllerAs:"name_controller"}}),r.directive("endGame",function(){return{templateUrl:"/partials/end.html"}})}(window.angular,window._),function(e,n){"use strict";var t=e.module("vehicles",["ngAnimate","speech","vehicles.directives"]);t.config(["$compileProvider",function(e){e.debugInfoEnabled(!1)}]),t.run(["Speech",function(e){e.language="en-GB",e.say("")}]),t.controller("GameController",["$scope","Speech","$interval","VEHICLES",function(e,n,t,r){var o=this;o.set_name=function(e){o.name=e,n.say("Hello "+e+". Let's play!").then(function(){o.advance_level()})};var c=[];o.levels=[],o.advance_level=function(){o.levels.shift();var e=c.shift();e?o.levels.push(e):o.is_complete=!0},o.restart=function(){o.name=null,o.is_complete=!1,c=i(r)},o.restart()}]);var r=3,i=function(e){var t=[],i=n.shuffle(e);return n.range(1,r+1).forEach(function(e){n.range(1,r+1).forEach(function(n){t.push({rows:e,columns:n,vehicle:i.pop()})})}),t.sort(function(e,n){return o(e)-o(n)}),t},o=function(e){var t=n.filter(n.values(e),n.isFinite),r=n.reduce(t,function(e,n){return e*n});return r}}(window.angular,window._);